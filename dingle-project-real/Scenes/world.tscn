[gd_scene load_steps=20 format=3 uid="uid://iysllbq6upr7"]

[ext_resource type="Script" uid="uid://sm1smey5c01l" path="res://Scripts/CharacterController.gd" id="1_a02cp"]
[ext_resource type="Texture2D" uid="uid://dmnucch5p364a" path="res://Assets/Textures/AnPhiastTemp.png" id="2_5ukr8"]
[ext_resource type="PackedScene" uid="uid://bjooqpqmpiw7u" path="res://Scenes/interaction_box.tscn" id="2_go701"]
[ext_resource type="PackedScene" uid="uid://bya28u4hoakii" path="res://Scenes/npc.tscn" id="4_8j60k"]
[ext_resource type="PackedScene" uid="uid://884rhrdouvah" path="res://Assets/Models/World/Backstreetblockout1.glb" id="5_fo5ed"]
[ext_resource type="PackedScene" uid="uid://d0878m5i3mail" path="res://Assets/Models/World/Backstreetblockout3.glb" id="6_o06y3"]
[ext_resource type="PackedScene" uid="uid://c2dejpm2lottk" path="res://Assets/Models/World/Backstreetblockout2.glb" id="7_k7acu"]
[ext_resource type="Script" uid="uid://45pssicrscyg" path="res://Scenes/UIManager.gd" id="8_ikia7"]
[ext_resource type="Script" uid="uid://pec5fvq7mcqp" path="res://Scenes/evidence_book.gd" id="8_k7acu"]
[ext_resource type="Resource" uid="uid://158iwhq64cex" path="res://Resources/TestEvidence.tres" id="9_5v1tr"]
[ext_resource type="Texture2D" uid="uid://cqrb0aqol3qk6" path="res://icon.svg" id="10_0fj1v"]
[ext_resource type="Shader" uid="uid://bscb7e5fasq7w" path="res://Shaders/screen_transition.gdshader" id="12_7yui6"]
[ext_resource type="Script" uid="uid://bwifi60ec7u1t" path="res://Scenes/scene_transition.gd" id="12_c5t2i"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_go701"]
sky_horizon_color = Color(0.66224277, 0.6717428, 0.6867428, 1)
ground_horizon_color = Color(0.66224277, 0.6717428, 0.6867428, 1)

[sub_resource type="Sky" id="Sky_5a7ea"]
sky_material = SubResource("ProceduralSkyMaterial_go701")

[sub_resource type="Environment" id="Environment_8j60k"]
background_mode = 2
sky = SubResource("Sky_5a7ea")
tonemap_mode = 2

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_5ukr8"]
points = PackedVector3Array(-0.12520654, -0.532801, -0.4805069, 0.022783129, 0.4760704, 0.49888408, 0.16971254, 0.5591441, 0.46417162, 0.23105091, -0.8035912, 0.32045516, 0.40741014, 0.651043, -0.24352328, -0.4827893, 0.59484255, 0.082213186, -0.3628679, -0.68231165, 0.2896967, 0.46904355, -0.65452886, -0.06627126, -0.12744367, 0.8427015, -0.33810276, -0.39343542, -0.6839421, -0.24471663, 0.43825462, 0.62330925, 0.20084947, 0.0841477, 0.977454, 0.11479468, -0.06820232, -0.9764576, -0.12927033, 0.20054972, -0.56312895, -0.4514544, -0.18552664, 0.59545326, -0.4534751, -0.27336287, 0.59226835, 0.40775412, -0.0069364863, -0.47682306, 0.49966025, 0.37582088, -0.5886136, 0.31695515, 0.111579016, 0.5630594, -0.48117727, -0.41725034, 0.5278656, -0.27049688, -0.48454633, -0.59697217, -0.06650971, -0.27974695, 0.90856135, 0.05333608, -0.25019687, -0.8807117, 0.20531891, 0.263647, -0.90277094, -0.1273943, 0.29336792, 0.8715263, -0.15719566, 0.3734115, -0.5263189, -0.32824618, 0.4996626, 0.47664148, -0.0068885577, 0.053105574, 0.8750009, 0.32470253, -0.15454252, -0.5908538, 0.4658794, -0.09727988, -0.7823577, -0.39818847, -0.3876489, -0.49817133, 0.31564978, -0.30067965, -0.58799505, -0.38890144)

[sub_resource type="BoxShape3D" id="BoxShape3D_e0ngr"]
size = Vector3(5, 1, 2)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_c5t2i"]
shader = ExtResource("12_7yui6")
shader_parameter/use_sprite_alpha = true
shader_parameter/use_transition_texture = false
shader_parameter/transition_type = 0
shader_parameter/position = Vector2(0.5, 0.5)
shader_parameter/invert = true
shader_parameter/grid_size = Vector2(5, 5)
shader_parameter/rotation_angle = 0.0
shader_parameter/stagger = Vector2(0, 0)
shader_parameter/stagger_frequency = Vector2i(2, 2)
shader_parameter/flip_frequency = Vector2i(1, 1)
shader_parameter/basic_feather = 0.0
shader_parameter/use_mask_size = false
shader_parameter/mask_size = Vector2(100, 100)
shader_parameter/edges = 6
shader_parameter/shape_feather = 0.1
shader_parameter/sectors = 1
shader_parameter/clock_feather = 0.0
shader_parameter/progress = 0.0
shader_parameter/progress_bias = Vector2(10, 10)

[node name="World" type="Node3D"]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.8660254, -0.43301278, 0.25, 0, 0.49999997, 0.86602545, -0.50000006, 0.75, -0.43301266, 0, 0, 0)
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_8j60k")

[node name="Player" type="CharacterBody3D" parent="." groups=["object"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 166.24248, -0.09342337, 8.8781395)
collision_layer = 129
script = ExtResource("1_a02cp")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("ConvexPolygonShape3D_5ukr8")

[node name="Pivot" type="Node3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.7295505, 0)

[node name="Camera3D" type="Camera3D" parent="Player/Pivot"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.4602914, 7.5778885)
size = 10.0
far = 150.0

[node name="Sprite3D" type="Sprite3D" parent="Player"]
transform = Transform3D(0.05, 0, 0, 0, 0.05, 0, 0, 0, 0.05, 0, 1.0013483, 0)
billboard = 1
texture = ExtResource("2_5ukr8")

[node name="InteractionBox" parent="." instance=ExtResource("2_go701")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 44.146297, 0.60232925, -8.513998)

[node name="NPC" parent="." instance=ExtResource("4_8j60k")]
transform = Transform3D(0.2, 0, 0, 0, 0.2, 0, 0, 0, 0.2, 44.985058, 1.9759264, -5.586557)

[node name="Backstreetblockout1" parent="." instance=ExtResource("5_fo5ed")]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, 43.589413, 0, -8.761587)

[node name="Backstreetblockout3" parent="." instance=ExtResource("6_o06y3")]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, 260.7209, -0.1538539, -14.140644)

[node name="Backstreetblockout2" parent="." instance=ExtResource("7_k7acu")]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, 146.16711, -0.4564437, -7.9923115)

[node name="UI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("8_ikia7")

[node name="EvidenceBook" type="Control" parent="UI" node_paths=PackedStringArray("image1", "image2", "description")]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("8_k7acu")
image1 = NodePath("Background/Polaroid1/Image")
image2 = NodePath("Background/Polaroid2/Image")
description = NodePath("Background/Label")
evidence = ExtResource("9_5v1tr")

[node name="Background" type="ColorRect" parent="UI/EvidenceBook"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.60784316)

[node name="Label" type="Label" parent="UI/EvidenceBook/Background"]
layout_mode = 1
anchors_preset = 13
anchor_left = 0.5
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -206.0
offset_top = 128.0
offset_right = 180.0
offset_bottom = -128.0
grow_horizontal = 2
grow_vertical = 2

[node name="Polaroid1" type="ColorRect" parent="UI/EvidenceBook/Background"]
layout_mode = 1
offset_left = 51.000008
offset_top = 72.0
offset_right = 301.0
offset_bottom = 347.0
rotation = -0.1308997

[node name="Image" type="TextureRect" parent="UI/EvidenceBook/Background/Polaroid1"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 27.0
offset_top = 26.0
offset_right = -27.0
offset_bottom = -59.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("10_0fj1v")

[node name="Polaroid2" type="ColorRect" parent="UI/EvidenceBook/Background"]
layout_mode = 1
offset_left = 839.99994
offset_top = 304.99997
offset_right = 1090.0
offset_bottom = 580.0
rotation = 0.20071286

[node name="Image" type="TextureRect" parent="UI/EvidenceBook/Background/Polaroid2"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 27.0
offset_top = 26.0
offset_right = -27.0
offset_bottom = -59.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("10_0fj1v")

[node name="Test Place" type="Node3D" parent="." groups=["place"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 58.79036, 1.4128742, -7.151163)

[node name="Transitions" type="Node" parent="."]

[node name="Street_To_Dock" type="Area3D" parent="Transitions"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 166.48979, 0, 0)
script = ExtResource("12_c5t2i")
teleport = "street_to_dock"

[node name="CollisionShape3D" type="CollisionShape3D" parent="Transitions/Street_To_Dock"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.31463623, 0.26734436, 6.692626)
shape = SubResource("BoxShape3D_e0ngr")
debug_color = Color(0.9764706, 0, 0.41960785, 0.9843137)

[node name="Dock_To_Street" type="Area3D" parent="Transitions"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 264.5704, 1.2578077, -20.682608)
script = ExtResource("12_c5t2i")
teleport = "dock_to_street"

[node name="CollisionShape3D" type="CollisionShape3D" parent="Transitions/Dock_To_Street"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.31463623, 0.26734436, 6.692626)
shape = SubResource("BoxShape3D_e0ngr")
debug_color = Color(0.9764706, 0, 0.41960785, 0.9843137)

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="ColorRect" type="ColorRect" parent="CanvasLayer"]
material = SubResource("ShaderMaterial_c5t2i")
offset_right = 1152.0
offset_bottom = 648.0
color = Color(0.16862746, 0.19215687, 0.19607843, 1)

[connection signal="interacted" from="InteractionBox" to="NPC" method="speak"]
[connection signal="body_shape_entered" from="Transitions/Street_To_Dock" to="Transitions/Street_To_Dock" method="_on_body_shape_entered"]
[connection signal="body_shape_entered" from="Transitions/Dock_To_Street" to="Transitions/Dock_To_Street" method="_on_body_shape_entered"]
